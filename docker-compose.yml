version: "3.9"

services:
	backend:
		build: .
		command: uvicorn backend.main:app --host 0.0.0.0 --port 8000
		ports:
			- "8000:8000"
		env_file: .env
		depends_on:
			- mongo
			- neo4j

	frontend:
		build: .
		command: streamlit run frontend/app.py --server.port 8501 --server.address 0.0.0.0
		ports:
			- "8501:8501"
		env_file: .env
		environment:
			- API_BASE_URL=http://backend:8000
		depends_on:
			- backend

	mongo:
		image: mongo:6
		ports:
			- "27017:27017"

	neo4j:
		image: neo4j:5
		ports:
			- "7474:7474"
			- "7687:7687"
		environment:
			- NEO4J_AUTH=neo4j/changeme
